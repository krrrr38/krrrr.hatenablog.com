---
Title: 現状1
Category:
- java
- Twitter Client
Date: 2011-03-03T15:02:18+09:00
URL: https://krrrr.hatenablog.com/entry/20110303/1299132138
EditURL: https://blog.hatena.ne.jp/krrrr/krrrr.hatenablog.com/atom/entry/11696248318756263093
---

[f:id:krrrr:20110303144748p:image]

本当にタブ付けただけで見た目補正70%増しですよさすがmacさん
取りあえず一段落させないと英語をやらないので日記を書く事で一段落したことにします
一応タブついてるんですけどTimeLine以外のパネルは空なんですけどね
基本的に夜フクロウユーザーなので夜フクロウをリスペクトした作りになってます
まぁSearchとか使えば任意のタグリストにもなるし夜フクロウには不自由してないので取りあえずはそこまで目指します
昨日の今日で加えた機能は次のような所でしょうか
-自分の発言と自分へのリプライに色をつける
　適当にTL見てても自分へのリプを発見出来るようになりました
-段々で色が若干異なる仕様
　正直微妙かもしれないです
-出力に色々言葉が出る用改善
　アウトプットらしいアウトプットを手に入れました
-<a href="http://bit.ly/" style="color:#ff00ff">bit.ly</a>を用いてurlの短縮機能をつけた
　url入力時に140字の制限を楽に出来る&見やすくするためにもつけました
-textareaや他欄に入力された文字を常にカウントさせる
　140字制限において今何文字なのかなどは重要なため…

基本的に正規表現によるパターンマッチばっかしてました
urlを取得しつつ、bit.lyで省略されたurlを再度省略するとエラーなどが発生してしまうためその部分の実装は次のようになりました
>||
import static com.rosaloves.bitlyj.Bitly.shorten;

import com.rosaloves.bitlyj.Bitly;
import com.rosaloves.bitlyj.Bitly.Provider;
…
public String textUrlUntill() {
		Pattern urlPtn = Pattern.compile("(https?|ftp):\\/\\/(?!bit\\.ly)[-_.!~*\\'()a-zA-Z0-9;\\/?:\\@&=+\\$,%#]+");
		Matcher m = urlPtn.matcher(text);
		while(m.find()){
			String changeurl = m.group(0).replaceAll("\\?","\\\\?");
			text = text.replaceAll(changeurl, shorterUrl(m.group(0)));
		}
		return text;
	}
	
	private static String shorterUrl(String targetUrl){
		Provider bitly = Bitly.as("アカウント名", "API key");
		return bitly.call(shorten(targetUrl)).getShortUrl();
	}
||<
urlに含まれた"?"が途中正規表現として扱われたりなんか色々でちょっと詰まってました
bit.lyのjavaでの使い方は上記の内容をそのまま使ってもらえたら後はダウンロードしたjarファイルにパスを通せば使えるはずです
次はTLの表示を見やすくする事ですかね
具体的には現在は"name : tweet"と表示されているのですがそこをしっかり分けてしまうとか
問題はリツイートされたツイートをどのように扱うかとかですね
適当に考えて見やすいように作ってみようと思います
